<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tf-idf • scNLP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tf-idf">
<meta property="og:description" content="scNLP">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scNLP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tf-idf.html">tf-idf</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bschilder/scNLP/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tf-idf_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tf-idf</h1>
                        <h4 class="author"><h5>
Author: <i>Brian M. Schilder</i>
</h5></h4>
            
            <h4 class="date"><h5>
Most recent update: <i>Jun-24-2021</i>
</h5></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bschilder/scNLP/blob/master/vignettes/tf-idf.Rmd"><code>vignettes/tf-idf.Rmd</code></a></small>
      <div class="hidden name"><code>tf-idf.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p>Term frequency–inverse document frequency (<strong>tf-idf</strong>) is an NLP technique to identify words or phrases that are enriched in one document relative to some other larger set of documents.</p>
<p>In our case, our words are within the non-standardized cell labels and our “documents” are the clusters. The goals is to find words that are enriched in each cluster relative to all the other clusters. This can be thought of as an NLP equivalent of finding gene markers for each cluster.</p>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bschilder/scNLP">scNLP</a></span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"pseudo_seurat"</span><span class="op">)</span></code></pre></div>
<div id="preprocessing" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing" class="anchor"></a>Preprocessing</h2>
<p>If you don’t already have a <code>Seurat</code> object with reduced dimensions and cluster assignments, you can generate a new one with the following support function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create some mock raw data </span>
<span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/AssayData.html">GetAssayData</a></span><span class="op">(</span><span class="va">pseudo_seurat</span><span class="op">)</span>
<span class="va">meta.data</span> <span class="op">&lt;-</span> <span class="va">pseudo_seurat</span><span class="op">@</span><span class="va">meta.data</span>

<span class="va">processed_seurat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seurat_pipeline.html">seurat_pipeline</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">counts</span>, 
                                    meta.data <span class="op">=</span> <span class="va">meta.data</span><span class="op">)</span></code></pre></div>
<pre><code>## Attaching SeuratObject</code></pre>
<pre><code>## Warning: Cannot find a parent environment called Seurat</code></pre>
<pre><code>## Warning in supportsMulticoreAndRStudio(...): [ONE-TIME WARNING] Forked
## processing ('multicore') is not supported when running R from RStudio
## because it is considered unstable. For more details, how to control forked
## processing or not, and how to silence this warning in future R sessions, see ?
## parallelly::supportsMulticore</code></pre>
<pre><code>## Centering and scaling data matrix</code></pre>
<pre><code>## PC_ 1 
## Positive:  RASGRF2, KCNC2, FRRS1L, CBX7, NIPAL2, ZBTB41, DGKE, DOC2A, FMN1, CNKSR2 
##     MAST1, RBM4, BTBD8, RAPGEF4, JDP2, HCN1, DOCK3, LMTK2, NAB1, RAP1GAP2 
##     INTU, ADNP2, PARP11, CCDC136, PHF1, ARHGAP26, GALNT13, INPP5E, SYNPR, BMS1 
## Negative:  GAPDHS, ALG10, SAP18, AGPAT6, IFI30, ATP6V1B1, CBS, HMGB2, RNA28S5, PHYHD1 
##     PAM16, WNT11, MCM5, SLC7A4, RNMTL1, GNAT2, TMEM184A, PHOX2B, RPSA, RDH13 
##     BOLA1, GSX2, TMX2, RPS19, EPCAM, ERCC6L, SLC38A4, MAD2L1, SERINC2, ALG11 
## PC_ 2 
## Positive:  UMAD1, SNHG22, MIR646HG, AC007193.6, CTD-2020K17.1, C1QTNF3-AMACR, AC092835.2, CFL1P1, LINC-PINT, AC009403.2 
##     LINS1, RP11-113E21.3, FAAH2, RP11-3B12.2, CTD-3105H18.18, RP11-11N7.5, CTB-171A8.1, RP11-848P1.9, USP32P3, TARID 
##     AC091133.1, RP11-1007O24.3, RP11-894J14.5, RP11-144F15.1, RP11-146D12.2, SDHAP1, RP1-184J9.2, RP11-1084E5.1, SCAMP1-AS1, RP11-382A20.4 
## Negative:  GPRASP1, HAGHL, ZNF664, EIF4G1, CRYZL1, UQCR11, FAM195A, LOC102288414, FNIP1, PYCR2 
##     EPHB3, CD320, MARS2, PDLIM2, ABCD1, AKT1S1, KISS1R, RWDD3, TMEM256, PCDHGC5 
##     C8orf37, MAZ, CHERP, BLOC1S3, DGAT2, GRPEL1, ZDHHC12, TMED1, EIF6, XBP1 
## PC_ 3 
## Positive:  RDH13, SLC7A4, RNMTL1, IFI30, AGPAT6, ALG11, TMEM179, CYB5D2, CBS, ALG10 
##     FKRP, AGO2, TTLL12, SGSM3, MAN1B1, MROH1, TMX2, TADA1, C15orf61, PAF1 
##     PHYHD1, PRPSAP2, RBM18, MESDC2, HEATR6, CAT, CBFB, MPDU1, FAF1, CCDC47 
## Negative:  RPS19, RPSA, HMGB2, CCT5, EIF3E, COX5A, TUBB, EIF3K, CLTA, SSR2 
##     PSMD8, SKP1, VDAC3, MYL12B, EIF3D, HSPD1, MLF2, SFPQ, MED10, EIF5B 
##     SYNCRIP, PRPF19, EIF6, ATP5L, C1D, MCM5, CHD4, RUVBL1, NIP7, MRPS21 
## PC_ 4 
## Positive:  ZNF285, ZNF468, RN7SL220P, RN7SL460P, DLEU2L, FAM241B, TMSB4Y, ZBTB20-AS4, ZNF781, PILRB 
##     ATAD3C, MTRNR2L1, CALM2, NBPF9, ZNF571-AS1, ANKK1, ZNF132, ZNF621, CDNF, PHLDB3 
##     BEST1, SLC2A1-AS1, ZNF66, HRH4, ZNF415, ZNF234, CCDC74B, ZNF554, FMNL1, SLCO1A2 
## Negative:  TMEM55A, UQCR11, C11orf57, TMEM234, SUV420H2, PAM16, C14orf79, AC084193.1, RP11-396J6.1, IMPG1 
##     RP11-122C21.1, RP11-556I14.1, RNMTL1, RP3-417G15.1, CNBD2, RP1-102E24.1, CTD-3222D19.12, RP11-486O12.2, RP11-615I2.6, CACNG5 
##     WBSCR27, PGLS, LOC102288414, SLC7A4, RP11-57A19.4, CTC-448D22.1, RP11-147L13.15, FAM195A, BOLA1, RP11-398M15.1 
## PC_ 5 
## Positive:  PGLS, MT1A, MTRNR2L1, LINC00571, ZNF132, ATAD3C, CXorf40A, TMEM234, AC084193.1, RP11-486O12.2 
##     RP11-615I2.6, CTD-3222D19.12, RP1-102E24.1, RP11-556I14.1, IMPG1, RP11-122C21.1, RP3-417G15.1, RP11-147L13.15, RP11-396J6.1, RP11-332J15.1 
##     RP11-57A19.4, RP11-731N10.1, RP11-49K24.4, RP4-758J18.13, RP11-569A11.1, CTC-248O19.1, RP11-395N3.2, TMED11P, RP11-398M15.1, CTC-448D22.1 
## Negative:  WHSC1, ANKRD32, C19orf40, HCN1, RASGRF2, LOC102288414, GABRB2, CHRM4, C6orf211, RP11-195B21.3 
##     AGAP9, KIAA2018, FSTL5, C1orf86, RAB1A, NARG2, C10orf118, ATP5L, DSCAML1, CCBL1 
##     KIAA0247, GPR61, KCNC2, C2CD4C, PLPP6, RP11-146D12.2, PTCHD1, KCNC1, RP11-897M7.4, RAP1GAP2</code></pre>
<pre><code>## Computing nearest neighbor graph</code></pre>
<pre><code>## Computing SNN</code></pre>
<pre><code>## Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
## To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
## This message will be shown once per session</code></pre>
<pre><code>## 15:39:35 UMAP embedding parameters a = 0.9922 b = 1.112</code></pre>
<pre><code>## 15:39:35 Read 801 rows and found 50 numeric columns</code></pre>
<pre><code>## 15:39:35 Using Annoy for neighbor search, n_neighbors = 30</code></pre>
<pre><code>## 15:39:35 Building Annoy index with metric = cosine, n_trees = 50</code></pre>
<pre><code>## 0%   10   20   30   40   50   60   70   80   90   100%</code></pre>
<pre><code>## [----|----|----|----|----|----|----|----|----|----|</code></pre>
<pre><code>## **************************************************|
## 15:39:35 Writing NN index file to temp file /var/folders/zq/h7mtybc533b1qzkys_ttgpth0000gn/T//RtmpMeSUNt/file225e75670fb2
## 15:39:35 Searching Annoy index using 10 threads, search_k = 3000
## 15:39:35 Annoy recall = 100%
## 15:39:35 Commencing smooth kNN distance calibration using 10 threads
## 15:39:35 Initializing from normalized Laplacian + noise
## 15:39:36 Commencing optimization for 500 epochs, with 31560 positive edges
## 15:39:37 Optimization finished
## Computing nearest neighbor graph
## Computing SNN</code></pre>
<pre><code>## Warning: The following arguments are not used: reduction</code></pre>
<pre><code>## Warning: The following arguments are not used: reduction</code></pre>
<pre><code>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck
## 
## Number of nodes: 801
## Number of edges: 15549
## 
## Running Louvain algorithm...
## Maximum modularity in 10 random starts: 0.9069
## Number of communities: 13
## Elapsed time: 0 seconds</code></pre>
</div>
<div id="td-idf-annotation" class="section level2">
<h2 class="hasAnchor">
<a href="#td-idf-annotation" class="anchor"></a>td-idf annotation</h2>
<p><code>seurat_tfidf</code> will run <strong>tf-idf</strong> on each cluster and put the results in the <strong>enriched_words</strong> and <strong>tf_idf</strong> cols of the <code>meta.data</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pseudo_seurat_tfidf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_tfidf.html">run_tfidf</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pseudo_seurat</span>,
                                 reduction <span class="op">=</span> <span class="st">"UMAP"</span>,
                                 cluster_var <span class="op">=</span> <span class="st">"cluster"</span>,
                                 label_var <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] "+ Extracting data from Seurat object."
## [1] "+ Using reduction: umap"</code></pre>
<pre><code>## Joining, by = "word"</code></pre>
<pre><code>## Joining, by = "cluster"
## Joining, by = "cluster"</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pseudo_seurat_tfidf</span><span class="op">@</span><span class="va">meta.data</span><span class="op">)</span></code></pre></div>
<pre><code>##                         cluster       batch species     dataset celltype label
## human.DRONC_human.ASC1        5 DRONC_human   human DRONC_human     ASC1  ASC1
## human.DRONC_human.ASC2        5 DRONC_human   human DRONC_human     ASC2  ASC2
## human.DRONC_human.END         9 DRONC_mouse   mouse DRONC_mouse      END   END
## human.DRONC_human.exCA1       0 DRONC_human   human DRONC_human    exCA1 exCA1
## human.DRONC_human.exCA3       0 DRONC_human   human DRONC_human    exCA3 exCA3
## human.DRONC_human.exDG        0 DRONC_human   human DRONC_human     exDG  exDG
##                         nCount_RNA nFeature_RNA RNA_snn_res.0.8 seurat_clusters
## human.DRONC_human.ASC1    237.9283          671               5               5
## human.DRONC_human.ASC2    232.7748          638               5               5
## human.DRONC_human.END     288.9631          616               9               9
## human.DRONC_human.exCA1   245.1858          669               0               0
## human.DRONC_human.exCA3   225.1575          675               0               0
## human.DRONC_human.exDG    237.8823          678               0               0
##                             UMAP_1      UMAP_2             enriched_words
## human.DRONC_human.ASC1  -0.4796632  0.17629431      glia; schwann; radial
## human.DRONC_human.ASC2  -0.6386602 -0.05231967      glia; schwann; radial
## human.DRONC_human.END   -7.7066403 -1.84134831 vascular; peric; pericytes
## human.DRONC_human.exCA1  6.2326443  1.51104526          lpn; adpn; neuron
## human.DRONC_human.exCA3  6.0303471  1.47096417          lpn; adpn; neuron
## human.DRONC_human.exDG   5.9316036  1.49563257          lpn; adpn; neuron
##                                                                             tf_idf
## human.DRONC_human.ASC1     0.198360552120631; 0.181900967132288; 0.111766521696813
## human.DRONC_human.ASC2     0.198360552120631; 0.181900967132288; 0.111766521696813
## human.DRONC_human.END                         0.528096815017439; 0.042313284392222
## human.DRONC_human.exCA1 0.0527542246967963; 0.0523351433907082; 0.0428030761818744
## human.DRONC_human.exCA3 0.0527542246967963; 0.0523351433907082; 0.0428030761818744
## human.DRONC_human.exDG  0.0527542246967963; 0.0523351433907082; 0.0428030761818744</code></pre>
</div>
<div id="td-idf-scatter-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#td-idf-scatter-plot" class="anchor"></a>td-idf scatter plot</h2>
<p>You can also plot the results in reduced dimensional space (e.g. UMAP). <code><a href="../reference/plot_tfidf.html">plot_tfidf()</a></code> will produce a list with three items. - <code>data</code>: The processed data used to create the plot. - <code>tfidf_df</code>: The full per-cluster TF-IDF enrichment results. - <code>plot</code>: The <code>ggplot</code>.</p>
<div id="seurat-input" class="section level3">
<h3 class="hasAnchor">
<a href="#seurat-input" class="anchor"></a><code>Seurat</code> input</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tfidf.html">plot_tfidf</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pseudo_seurat</span>, 
                  label_var <span class="op">=</span> <span class="st">"celltype"</span>, 
                  cluster_var <span class="op">=</span> <span class="st">"cluster"</span>, 
                  show_plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "+ Extracting data from Seurat object."
## [1] "+ Using reduction: umap"</code></pre>
<pre><code>## Joining, by = "word"</code></pre>
<pre><code>## Joining, by = "cluster"
## Joining, by = "cluster"</code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: label</code></pre>
<p><img src="tf-idf_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>You can color the point by other metadata attributes instead.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tfidf.html">plot_tfidf</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pseudo_seurat</span>, 
                  label_var <span class="op">=</span> <span class="st">"celltype"</span>, 
                  cluster_var <span class="op">=</span> <span class="st">"cluster"</span>, 
                  color_var <span class="op">=</span> <span class="st">"batch"</span>,
                  show_plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "+ Extracting data from Seurat object."
## [1] "+ Using reduction: umap"</code></pre>
<pre><code>## Joining, by = "word"</code></pre>
<pre><code>## Joining, by = "cluster"
## Joining, by = "cluster"</code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: label</code></pre>
<p><img src="tf-idf_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="singlecellexperiment-input" class="section level3">
<h3 class="hasAnchor">
<a href="#singlecellexperiment-input" class="anchor"></a><code>SingleCellExperiment</code> input</h3>
<p><code><a href="../reference/plot_tfidf.html">plot_tfidf()</a></code> can also take in an object of class <code>SingleCellExperiment</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"pseudo_sce"</span><span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tfidf.html">plot_tfidf</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pseudo_sce</span>, 
                  label_var <span class="op">=</span> <span class="st">"celltype"</span>, 
                  cluster_var <span class="op">=</span> <span class="st">"cluster"</span>, 
                  show_plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div id="list-input" class="section level3">
<h3 class="hasAnchor">
<a href="#list-input" class="anchor"></a><code>list</code> input</h3>
<p>Lastly, if your data doesn’t fit the above example data types, you can simply supply a named <code>list</code> with <strong>metadata</strong> and <strong>embeddings</strong>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="fu">SingleCellExperiment</span><span class="fu">::</span><span class="fu">colData</span><span class="op">(</span><span class="va">pseudo_sce</span><span class="op">)</span>,
                  embeddings <span class="op">=</span> <span class="fu">SingleCellExperiment</span><span class="fu">::</span><span class="fu">colData</span><span class="op">(</span><span class="va">pseudo_sce</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UMAP.1"</span>,<span class="st">"UMAP.2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tfidf.html">plot_tfidf</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">data_list</span>,
                  label_var <span class="op">=</span> <span class="st">"celltype"</span>, 
                  cluster_var <span class="op">=</span> <span class="st">"cluster"</span>, 
                  show_plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "+ Using data from list."</code></pre>
<pre><code>## Joining, by = "word"</code></pre>
<pre><code>## Joining, by = "cluster"
## Joining, by = "cluster"</code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: label</code></pre>
<p><img src="tf-idf_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div id="interactive-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#interactive-mode" class="anchor"></a>Interactive mode</h3>
<p>You can also create an interactive version of this plot.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tfidf.html">plot_tfidf</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pseudo_seurat_tfidf</span>,
                  label_var <span class="op">=</span> <span class="st">"celltype"</span>, 
                  cluster_var <span class="op">=</span> <span class="st">"cluster"</span>, 
                  interact <span class="op">=</span> <span class="cn">T</span>,
                  show_plot <span class="op">=</span> <span class="cn">T</span>,
                  <span class="co">### Add other metadata vars you want in the hover label like so:</span>
                  species<span class="op">=</span><span class="st">"species"</span>,
                  dataset<span class="op">=</span><span class="st">"dataset"</span>, 
                  enriched_words<span class="op">=</span><span class="st">"enriched_words"</span>,
                  tf_idf<span class="op">=</span><span class="st">"tf_idf"</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] "+ Extracting data from Seurat object."
## [1] "+ Using reduction: umap"</code></pre>
<pre><code>## Joining, by = "word"</code></pre>
<pre><code>## Joining, by = "cluster"
## Joining, by = "cluster"</code></pre>
</div>
</div>
</div>
<div id="tf-idf-wordcloud" class="section level1">
<h1 class="hasAnchor">
<a href="#tf-idf-wordcloud" class="anchor"></a>tf-idf wordcloud</h1>
<p>You can also show the per-cluster <strong>tf-idk</strong> results as a wordcloud.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wordcloud_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wordcloud_tfidf.html">wordcloud_tfidf</a></span><span class="op">(</span>object<span class="op">=</span><span class="va">pseudo_seurat</span>,
                                 label_var <span class="op">=</span> <span class="st">"celltype"</span>, 
                                 cluster_var <span class="op">=</span> <span class="st">"cluster"</span>, 
                                 terms_per_cluster<span class="op">=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "+ Extracting data from Seurat object."
## [1] "+ Using reduction: umap"</code></pre>
<pre><code>## Joining, by = "word"</code></pre>
<pre><code>## Joining, by = "cluster"
## Joining, by = "cluster"</code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: label</code></pre>
<pre><code>## Warning in wordcloud_boxes(data_points = points_valid_first, boxes = boxes, :
## One word could not fit on page. It has been placed at its original position.</code></pre>
<p><img src="tf-idf_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">wordcloud_res</span><span class="op">$</span><span class="va">tfidf_df</span><span class="op">)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'cli':
##   method     from         
##   print.boxx spatstat.geom</code></pre>
<pre><code>## # A tibble: 147 x 8
## # Groups:   cluster [15]
##    cluster word        n total samples      tf   idf tf_idf
##    &lt;fct&gt;   &lt;chr&gt;   &lt;int&gt; &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 0       lpn         3   154     129 0.0195   2.71 0.0528
##  2 0       adpn        4   154     129 0.0260   2.01 0.0523
##  3 0       neuron      6   154     129 0.0390   1.10 0.0428
##  4 0       neurons     5   154     129 0.0325   1.10 0.0357
##  5 0       ex6a        2   154     129 0.0130   2.71 0.0352
##  6 0       pm1         2   154     129 0.0130   2.71 0.0352
##  7 0       proc        2   154     129 0.0130   2.71 0.0352
##  8 0       c2          1   154     129 0.00649  2.71 0.0176
##  9 0       c3          1   154     129 0.00649  2.71 0.0176
## 10 0       ca1pyr1     1   154     129 0.00649  2.71 0.0176
## # … with 137 more rows</code></pre>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<details><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggwordcloud_0.5.0  ggplot2_3.3.4      tidytext_0.3.1     future_1.21.0     
## [5] SeuratObject_4.0.2 Seurat_4.0.3       scNLP_0.1.0       
## 
## loaded via a namespace (and not attached):
##   [1] systemfonts_1.0.2           plyr_1.8.6                 
##   [3] igraph_1.2.6                lazyeval_0.2.2             
##   [5] splines_4.1.0               crosstalk_1.1.1            
##   [7] listenv_0.8.0               SnowballC_0.7.0            
##   [9] scattermore_0.7             GenomeInfoDb_1.28.0        
##  [11] digest_0.6.27               htmltools_0.5.1.1          
##  [13] fansi_0.5.0                 magrittr_2.0.1             
##  [15] memoise_2.0.0               tensor_1.5                 
##  [17] cluster_2.1.2               ROCR_1.0-11                
##  [19] globals_0.14.0              matrixStats_0.59.0         
##  [21] pkgdown_1.6.1               spatstat.sparse_2.0-0      
##  [23] colorspace_2.0-2            ggrepel_0.9.1              
##  [25] textshaping_0.3.5           xfun_0.24                  
##  [27] dplyr_1.0.7                 RCurl_1.98-1.3             
##  [29] crayon_1.4.1                jsonlite_1.7.2             
##  [31] Exact_2.1                   spatstat.data_2.1-0        
##  [33] survival_3.2-11             zoo_1.8-9                  
##  [35] glue_1.4.2                  polyclip_1.10-0            
##  [37] pals_1.7                    gtable_0.3.0               
##  [39] zlibbioc_1.38.0             XVector_0.32.0             
##  [41] leiden_0.3.8                DelayedArray_0.18.0        
##  [43] SingleCellExperiment_1.14.1 future.apply_1.7.0         
##  [45] BiocGenerics_0.38.0         maps_3.3.0                 
##  [47] abind_1.4-5                 scales_1.1.1               
##  [49] mvtnorm_1.1-2               DBI_1.1.1                  
##  [51] miniUI_0.1.1.1              Rcpp_1.0.6                 
##  [53] isoband_0.2.4               viridisLite_0.4.0          
##  [55] xtable_1.8-4                reticulate_1.20            
##  [57] spatstat.core_2.2-0         mapproj_1.2.7              
##  [59] proxy_0.4-26                stats4_4.1.0               
##  [61] htmlwidgets_1.5.3           httr_1.4.2                 
##  [63] RColorBrewer_1.1-2          ellipsis_0.3.2             
##  [65] ica_1.0-2                   farver_2.1.0               
##  [67] pkgconfig_2.0.3             sass_0.4.0                 
##  [69] uwot_0.1.10                 deldir_0.2-10              
##  [71] utf8_1.2.1                  labeling_0.4.2             
##  [73] tidyselect_1.1.1            rlang_0.4.11               
##  [75] reshape2_1.4.4              later_1.2.0                
##  [77] munsell_0.5.0               tools_4.1.0                
##  [79] cachem_1.0.5                cli_2.5.0                  
##  [81] generics_0.1.0              ggridges_0.5.3             
##  [83] evaluate_0.14               stringr_1.4.0              
##  [85] fastmap_1.1.0               yaml_2.2.1                 
##  [87] ragg_1.1.3                  goftest_1.2-2              
##  [89] knitr_1.33                  fs_1.5.0                   
##  [91] fitdistrplus_1.1-5          purrr_0.3.4                
##  [93] RANN_2.6.1                  rootSolve_1.8.2.1          
##  [95] pbapply_1.4-3               nlme_3.1-152               
##  [97] mime_0.11                   tokenizers_0.2.1           
##  [99] compiler_4.1.0              rstudioapi_0.13            
## [101] plotly_4.9.4.1              png_0.1-7                  
## [103] e1071_1.7-7                 spatstat.utils_2.2-0       
## [105] tibble_3.1.2                bslib_0.2.5.1              
## [107] DescTools_0.99.42           stringi_1.6.2              
## [109] highr_0.9                   desc_1.3.0                 
## [111] RSpectra_0.16-0             lattice_0.20-44            
## [113] Matrix_1.3-4                vctrs_0.3.8                
## [115] pillar_1.6.1                lifecycle_1.0.0            
## [117] spatstat.geom_2.2-0         lmtest_0.9-38              
## [119] jquerylib_0.1.4             RcppAnnoy_0.0.18           
## [121] bitops_1.0-7                data.table_1.14.0          
## [123] cowplot_1.1.1               irlba_2.3.3                
## [125] lmom_2.8                    GenomicRanges_1.44.0       
## [127] httpuv_1.6.1                patchwork_1.1.1            
## [129] R6_2.5.0                    promises_1.2.0.1           
## [131] KernSmooth_2.23-20          gridExtra_2.3              
## [133] IRanges_2.26.0              janeaustenr_0.1.5          
## [135] parallelly_1.26.0           gld_2.6.2                  
## [137] codetools_0.2-18            dichromat_2.0-0            
## [139] boot_1.3-28                 MASS_7.3-54                
## [141] assertthat_0.2.1            SummarizedExperiment_1.22.0
## [143] rprojroot_2.0.2             withr_2.4.2                
## [145] sctransform_0.3.2           GenomeInfoDbData_1.2.6     
## [147] S4Vectors_0.30.0            mgcv_1.8-36                
## [149] expm_0.999-6                parallel_4.1.0             
## [151] grid_4.1.0                  rpart_4.1-15               
## [153] tidyr_1.1.3                 class_7.3-19               
## [155] rmarkdown_2.9               MatrixGenerics_1.4.0       
## [157] Rtsne_0.15                  Biobase_2.52.0             
## [159] shiny_1.6.0</code></pre>
</details>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Brian Schilder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
